import{r as _,j as T,s as N,a6 as R,a7 as s,a9 as S,ak as t,aa as e,al as i,am as n,ab as f,an as c,ac as b}from"./index.0d3749aa.js";import{Q as j}from"./QBadge.b7d5b574.js";import{Q as B,a as g}from"./QTable.6d3344bf.js";import{Q as C}from"./QPage.22d0f341.js";import{b as x}from"./axios.ca9091c1.js";import{u as V}from"./use-quasar.192cb9b2.js";import"./QList.efe7843a.js";import"./QSelect.924c04e8.js";import"./QItem.78bfbbe5.js";import"./format.d4152734.js";const U={class:"tw-grid tw-grid-cols-1 md:tw-grid-cols-4 tw-gap-6 tw-mb-6"},k={class:"tw-flex tw-items-center tw-justify-between"},z={class:"tw-text-2xl tw-font-bold"},F={class:"tw-flex tw-items-center tw-justify-between"},I={class:"tw-text-2xl tw-font-bold"},P={class:"tw-flex tw-items-center tw-justify-between"},$={class:"tw-text-2xl tw-font-bold"},M={class:"tw-flex tw-items-center tw-justify-between"},E={class:"tw-text-2xl tw-font-bold"},at={__name:"Dashboard",setup(H){const h=V(),r=_({total_units:0,total_users:0,today_requests:0,total_requests:0,total_cost:0,currency:"USD"}),v=_([]),m=_(!1),D=[{name:"id",label:"ID",field:"id",align:"left"},{name:"unit",label:"Unidade",field:"unit",align:"left"},{name:"provider",label:"Provedor",field:"provider",align:"left"},{name:"status",label:"Status",field:"status",align:"left"},{name:"cost",label:"Custo",field:"cost",align:"right"},{name:"created_at",label:"Data",field:"created_at",align:"left"}],Q=T(()=>r.value.currency||"USD"),p=(l,o)=>{const a=Number(l)||0,u=o||Q.value,w=Math.abs(a),d=w<1?6:2,q=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:w<1?4:2,maximumFractionDigits:d}).format(a);return`${u} ${q}`},y=l=>l?new Intl.DateTimeFormat("pt-BR",{dateStyle:"short",timeStyle:"short"}).format(new Date(l)):"-";return N(async()=>{var l,o;m.value=!0;try{const[a,u]=await Promise.all([x.get("/api/admin/dashboard/overview"),x.get("/api/admin/dashboard/recent-requests")]);r.value=a.data.data||a.data;const w=u.data.data||u.data||[];v.value=w.map(d=>({...d,cost_formatted:p(d.cost,d.cost_currency),created_at_formatted:y(d.created_at)}))}catch(a){console.error("Erro ao carregar dashboard:",a),h.notify({type:"negative",message:"N\xE3o foi poss\xEDvel carregar os dados do dashboard",caption:((o=(l=a.response)==null?void 0:l.data)==null?void 0:o.message)||a.message})}finally{m.value=!1}}),(l,o)=>(S(),R(C,{class:"tw-p-6"},{default:s(()=>[o[5]||(o[5]=t("div",{class:"tw-mb-6"},[t("h1",{class:"tw-text-3xl tw-font-bold"},"Dashboard"),t("p",{class:"tw-text-gray-600"},"Vis\xE3o geral do sistema")],-1)),t("div",U,[e(c,{flat:"",bordered:"",class:"tw-shadow-none tw-h-full"},{default:s(()=>[e(i,{class:"tw-p-4"},{default:s(()=>[t("div",k,[t("div",null,[o[0]||(o[0]=t("p",{class:"tw-text-gray-600 tw-text-sm"},"Total de Unidades",-1)),t("p",z,n(r.value.total_units||0),1)]),e(f,{name:"business",size:"48px",color:"primary"})])]),_:1})]),_:1}),e(c,{flat:"",bordered:"",class:"tw-shadow-none tw-h-full"},{default:s(()=>[e(i,{class:"tw-p-4"},{default:s(()=>[t("div",F,[t("div",null,[o[1]||(o[1]=t("p",{class:"tw-text-gray-600 tw-text-sm"},"Total de Usu\xE1rios",-1)),t("p",I,n(r.value.total_users||0),1)]),e(f,{name:"people",size:"48px",color:"secondary"})])]),_:1})]),_:1}),e(c,{flat:"",bordered:"",class:"tw-shadow-none tw-h-full"},{default:s(()=>[e(i,{class:"tw-p-4"},{default:s(()=>[t("div",P,[t("div",null,[o[2]||(o[2]=t("p",{class:"tw-text-gray-600 tw-text-sm"},"Requisi\xE7\xF5es Hoje",-1)),t("p",$,n(r.value.today_requests||0),1)]),e(f,{name:"analytics",size:"48px",color:"positive"})])]),_:1})]),_:1}),e(c,{flat:"",bordered:"",class:"tw-shadow-none tw-h-full"},{default:s(()=>[e(i,{class:"tw-p-4"},{default:s(()=>[t("div",M,[t("div",null,[o[3]||(o[3]=t("p",{class:"tw-text-gray-600 tw-text-sm"},"Custo Total",-1)),t("p",E,n(p(r.value.total_cost,r.value.currency)),1)]),e(f,{name:"attach_money",size:"48px",color:"warning"})])]),_:1})]),_:1})]),e(c,{flat:"",bordered:"",class:"tw-shadow-none"},{default:s(()=>[e(i,{class:"tw-p-4"},{default:s(()=>[o[4]||(o[4]=t("h2",{class:"tw-text-xl tw-font-bold tw-mb-4"},"\xDAltimas Requisi\xE7\xF5es",-1)),e(B,{rows:v.value,columns:D,"row-key":"id",loading:m.value,flat:"","no-data-label":"Nenhuma requisi\xE7\xE3o encontrada"},{"body-cell-status":s(a=>[e(g,{props:a},{default:s(()=>[e(j,{color:a.value==="success"?"positive":"negative"},{default:s(()=>[b(n(a.value),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-cost":s(a=>[e(g,{props:a},{default:s(()=>[b(n(p(a.row.cost,a.row.cost_currency)),1)]),_:2},1032,["props"])]),"body-cell-created_at":s(a=>[e(g,{props:a},{default:s(()=>[b(n(y(a.row.created_at)),1)]),_:2},1032,["props"])]),_:1},8,["rows","loading"])]),_:1})]),_:1})]),_:1}))}};export{at as default};
