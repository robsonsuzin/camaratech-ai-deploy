import{r as d,a9 as _,a6 as N,a7 as v,aa as l,ak as o,ab as L,b7 as U,am as x,b4 as h,ad as I,bj as O,al as P,bg as $,an as j,bk as R,a5 as F,b3 as J,bl as c,s as D,ac as A,b2 as m,b5 as M,b6 as G,bm as H,bf as K,aB as W,b8 as T,bi as X}from"./index.043ac35e.js";import{Q as Y}from"./QForm.00c29b02.js";import{useAuth as Z}from"./auth.5350a00f.js";import{n as Q}from"./axios.fafc493e.js";import{u as ee}from"./use-quasar.31251b42.js";import"./pinia.a0e130f5.js";const ae={class:"tw-flex tw-items-center"},te={class:"text-subtitle q-mb-none"},se={key:0},b={__name:"CardInfo",props:{visible:{type:Boolean,default:!0},type:String,title:String,msg:String,icon:String,color:String,noicon:Boolean,class:String,compact:{type:Boolean,default:!1},btn:{type:Boolean,default:!1},btnProps:{type:Object,default:()=>({color:"primary",size:"sm",outlined:!0,label:"A\xE7\xE3o"})}},emits:["btnClick"],setup(z,{emit:w}){const t=z,u=w,r=d(),n=d();function y(){u("btnClick")}function p(){var f,g,i,k,q,C,S,B;return t.type==="warning"&&(r.value=(f=t.color)!=null?f:"orange",n.value=(g=t.icon)!=null?g:"warning"),t.type==="success"&&(r.value=(i=t.color)!=null?i:"green",n.value=(k=t.icon)!=null?k:"check_circle"),t.type==="error"&&(r.value=(q=t.color)!=null?q:"red",n.value=(C=t.icon)!=null?C:"error"),t.type==="info"&&(r.value=(S=t.color)!=null?S:"blue",n.value=(B=t.icon)!=null?B:"info"),n.value=t.noicon?null:n.value,t.compact?"col-12 text-subtitle text-weight-light bg-"+r.value+"-1 "+t.class:"col-12 text-h6 text-weight-light q-mb-md bg-"+r.value+"-1 "+t.class}return(f,g)=>t.visible?(_(),N(j,{key:0,flat:"",bordered:"",class:$(p())},{default:v(()=>[l(P,{class:"tw-flex tw-items-center tw-justify-between"},{default:v(()=>[o("div",ae,[z.noicon?U("",!0):(_(),N(L,{key:0,name:n.value,color:r.value,size:t.compact==!0?"1.3rem":"2rem",class:"tw-pr-3"},null,8,["name","color","size"])),o("div",null,[o("b",null,x(t.title),1),o("p",te,x(t.msg),1)])]),t.btn?(_(),h("div",se,[l(I,O(t.btnProps,{onClick:y}),null,16)])):U("",!0)]),_:1})]),_:1},8,["class"])):U("",!0)}};const le={class:"flex flex-center bg-grey-3",style:{"min-height":"100vh"}},oe={class:"tw-bg-white tw-p-6 tw-border tw-shadow-lg tw-rounded-lg",style:{width:"500px"}},ie={key:0,class:"q-mb-md"},re={class:"row q-gutter-sm"},ne={class:"row items-center"},ue={class:"col-auto"},ce={class:"col q-ml-sm"},me={class:"text-subtitle2"},de={class:"text-caption"},ve={class:"col-auto"},pe={class:"col-12"},fe={class:"tw-flex tw-justify-between tw-items-center tw-mt-0"},ge={__name:"Login",setup(z){ee();const w=Z(),t=F(),u=J(),r=d(c.get("cookie_email")||""),n=d(c.get("cookie_password")||""),y=d(!1),p=d(null),f=d(Boolean(c.get("cookie_remember"))),g=d({error:null,message:null,exception:null}),i=d([]);function k(){const s=c.get("camaratech_ai_saved_users");if(s)try{typeof s=="string"?i.value=JSON.parse(s):Array.isArray(s)?i.value=s:i.value=[]}catch(e){console.error("Erro ao carregar usu\xE1rios salvos:",e),i.value=[]}}function q(s){const e=i.value.findIndex(a=>a.email===s.email);e>=0?i.value[e]=s:(i.value.length>=5&&i.value.shift(),i.value.push(s)),c.set("camaratech_ai_saved_users",JSON.stringify(i.value),{expires:30,path:"/"})}function C(s){p.value=s,r.value=s.email,n.value=s.password||""}function S(s){var e;i.value=i.value.filter(a=>a.email!==s),c.set("camaratech_ai_saved_users",JSON.stringify(i.value),{expires:30,path:"/"}),((e=p.value)==null?void 0:e.email)===s&&(p.value=null)}D(()=>{k()});async function B(){var s;if(y.value=!0,!r.value&&!n.value){Q.error("Preencha o e-mail e senha para entrar!"),y.value=!1;return}try{await w.sanctum();const e=await w.login(r.value,n.value);if(console.log(e),await w.me(),f.value){c.set("cookie_email",r.value),c.set("cookie_password",n.value),c.set("cookie_remember",!0);const a=e.data.data||e.data,V=a.first_name&&a.last_name?a.first_name+" "+a.last_name:a.full_name||a.email;q({email:r.value,name:V,password:n.value})}Q.success("Bem-Vindo ao CamaraTech AI! :)"),t.push({name:"dashboard"})}catch(e){console.log(e),(s=e.response)!=null&&s.data?(g.value=e.response.data,Q.error(e.response.data.message||"Erro ao fazer login")):Q.error("Erro ao fazer login")}finally{y.value=!1}}return(s,e)=>(_(),h("div",le,[o("div",oe,[e[6]||(e[6]=o("div",{class:"tw-font-sans tw-text-3xl tw-pb-8 tw-pt-2 tw-text-center text-primary"},[o("b",null,"Camara"),A("Tech "),o("b",null,"AI")],-1)),l(b,{visible:Boolean(m(u).query.register),type:"warning",title:"Ol\xE1, "+m(u).query.first_name,msg:"Foi enviado uma mensagem no seu whatsapp pra confirma\xE7\xE3o da conta!"},null,8,["visible","title"]),l(b,{visible:Boolean(m(u).query.confirm),type:"success",title:m(u).query.first_name,msg:"Sua conta foi confirmada com sucesso, digite sua senha para entrar!"},null,8,["visible","title"]),l(b,{visible:Boolean(m(u).query.reset),type:"success",title:m(u).query.first_name,msg:"Sua senha foi alterada com sucesso!"},null,8,["visible","title"]),l(b,{visible:Boolean(m(u).query.error==="InvalidConfirmationException"),type:"error",title:"Que Pena!",msg:"Token inv\xE1lido, vc precisa solicitar em Recuperar Acesso!"},null,8,["visible"]),l(b,{visible:Boolean(m(u).query.error==="TokenInvalidException"),type:"error",title:"Que Pena!",msg:"Token inv\xE1lido, vc precisa solicitar em Recuperar Acesso!"},null,8,["visible"]),l(b,{visible:Boolean(m(u).query.error==="UserAlreadyVerifiedException"),type:"success",title:"Tudo Certo! :)",msg:"Seu usu\xE1rio j\xE1 est\xE1 verificado!"},null,8,["visible"]),l(b,{visible:g.value.exception==="AuthException",type:"warning",title:"Falha na autentica\xE7\xE3o!",msg:g.value.message},null,8,["visible","msg"]),i.value.length>0?(_(),h("div",ie,[e[3]||(e[3]=o("div",{class:"text-subtitle2 text-grey-7 q-mb-sm"},"Usu\xE1rios Salvos",-1)),o("div",re,[(_(!0),h(M,null,G(i.value,a=>{var V;return _(),h("div",{key:a.email,class:"col-12"},[l(j,{flat:"",bordered:"",class:$(["cursor-pointer hover-card",{"bg-primary text-white":((V=p.value)==null?void 0:V.email)===a.email}]),onClick:E=>C(a)},{default:v(()=>[l(P,{class:"q-pa-sm"},{default:v(()=>{var E;return[o("div",ne,[o("div",ue,[l(H,{size:"40px",color:((E=p.value)==null?void 0:E.email)===a.email?"white":"primary","text-color":"primary"},{default:v(()=>[A(x(a.name.charAt(0).toUpperCase()),1)]),_:2},1032,["color"])]),o("div",ce,[o("div",me,x(a.name),1),o("div",de,x(a.email),1)]),o("div",ve,[l(I,{flat:"",dense:"",round:"",icon:"close",size:"sm",onClick:K(be=>S(a.email),["stop"])},null,8,["onClick"])])])]}),_:2},1024)]),_:2},1032,["class","onClick"])])}),128))]),l(W,{class:"q-my-md"})])):U("",!0),o("div",pe,[l(Y,{onSubmit:B,class:"q-gutter-y-sm"},{default:v(()=>[l(T,{outlined:"",class:"q-pb-lg",modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),label:"Email",autocomplete:"email",rules:[a=>!!a||"Digite o email"]},null,8,["modelValue","rules"]),l(T,{outlined:"",class:"q-pb-lg",modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value=a),type:"password",label:"Senha",autocomplete:"current-password",rules:[a=>!!a||"Digite sua senha"]},null,8,["modelValue","rules"]),o("div",null,[l(X,{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=a=>f.value=a),label:"Lembrar dados!","false-value":!1,"true-value":!0,"right-label":""},null,8,["modelValue"])]),o("div",fe,[l(I,{flat:"",to:"/login/esqueci-senha/?email="+r.value,class:"text-black-50"},{default:v(()=>[...e[4]||(e[4]=[A("Recuperar Acesso?",-1)])]),_:1},8,["to"]),l(I,{class:"tw-px-5 tw-py-3 tw-rounded-lg",color:"primary",size:"md",type:"submit",loading:y.value},{default:v(()=>[...e[5]||(e[5]=[A("Entrar",-1)])]),_:1},8,["loading"])])]),_:1})])])]))}};var qe=R(ge,[["__scopeId","data-v-499d3d55"]]);export{qe as default};
